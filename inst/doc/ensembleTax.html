<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>ensembleTax overview</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>ensembleTax overview</h1>

<p>ensembleTax is an R package that allows incorporation of information from 
multiple taxonomic assignment algorithms and/or reference databases to compute 
ensemble taxonomic assignments for ASVs/OTUs generated by common marker gene 
sequence analyses. </p>

<p>Please note that this is a simple vignette to demonstrate the functionality of 
the package. For more detailed discussion and example uses, see here:
<a href="https://github.com/dcat4/ensembleTax/blob/master/README.md">https://github.com/dcat4/ensembleTax/blob/master/README.md</a></p>

<h2>The problem</h2>

<p>Taxonomic assignment of marker gene sequences is a critical step of marker gene
workflows as it imparts ecological significance and understanding to genetic 
data.</p>

<p>Many taxonomic assignment algorithms have been proposed to assign taxonomy to 
marker gene sequences (or OTUs/ASVs). Similarly, analysts are often forced to 
choose from one of several reference databases containing representative 
marker gene sequences with known taxonomic identities. The &ldquo;best&rdquo; assignment 
algorithm and/or reference database for a particular scientific question is 
often not obvious. To complicate things further, different reference databases 
generally do not share consistent taxonomic naming or ranking conventions. </p>

<p>ensembleTax solves this problem by providing flexible algorithms that synthesize
information from multiple taxonomic assignment algorithm/reference database 
combinations and compute a single ensemble taxonomic assignment for each ASV/OTU
in a marker gene data set. </p>

<h2>ensembleTax algorithms</h2>

<p>The core algorithms employed by ensembleTax are <em>taxmapper</em> and <em>ensembleTax</em>.
<em>taxmapper</em> maps, or &#39;translates&#39;, one taxonomic nomenclature onto another by 
exact name matching. <em>taxmapper</em> is rank-agnostic, meaning it does not consider
the hierarchical structure of a taxonomy and assumes that a taxonomic name means
the same thing regardless of which reference database employs it. </p>

<p><em>ensembleTax</em> computes ensemble taxonomic assignments based on assignments 
determined by any number of individual taxonomic assignment algorithm/reference
database combinations. Several parameters allow the user to control trade-offs
in the accuracy vs. resolution of taxonomic assignments.</p>

<p>Additional functions are included for pre-processing taxonomic assignments 
generated by specific taxonomic assignment algorithms and reference databases. 
These functions are designed to conveniently plug in downstream of the dada2 
pipeline, but other pipelines may be used if the data is formatted properly for 
use with <em>taxmapper</em> and/or <em>ensembleTax</em>.</p>

<p>The taxonomic assignment algorithms explicitly supported by ensembleTax are:</p>

<ol>
<li>bayesian classifier as implemented in dada2&#39;s assignTaxonomy.</li>
<li>idtaxa algorithm as implemented in DECIPHER. </li>
</ol>

<p>Supported reference databases include:</p>

<ol>
<li>Silva SSU NR reference database (silva).</li>
<li>Protistan Ribosomal Reference database (pr2).</li>
<li>RDP train set v16</li>
<li>GreenGenes v13.8 clustered at 97% similarity</li>
</ol>

<p>Note that other databases may still be used with ensembleTax, but they must be 
mapped onto the taxonomic nomenclatures employed by Silva and/or pr2 using 
<em>taxmapper</em>, or they must be re-formatted appropriately for use with 
<em>taxmapper</em>. Follow the link above for vignettes demonstrating how to 
incorporate custom reference databases into your ensembleTax workflow.</p>

<h3>ensembleTax &#39;pipeline&#39; demonstration</h3>

<p>Here we step through a simple example of an ensembleTax workflow to compute 
ensemble taxonomic assignments for a small set of 18S-V9 protist ASVs.</p>

<p>First, load some data included with the ensembleTax package. These are outputs
of dada2&#39;s assignTaxonomy implemented against pr2, and of DECIPHER&#39;s idtaxa 
implemented against both pr2 and silva. The rubric.sample is an example of a 
&ldquo;rubric&rdquo;, which ensembleTax uses to track ASV-identifying information. 
The rubric is a DNAStringSet (see the Biostrings package) object produced by 
extracting ASV sequences from the seqtab used by dada2, and giving them 
arbitrary names (like sv1, sv2, etc). </p>

<pre><code class="r">library(&quot;ensembleTax&quot;)
library(&quot;Biostrings&quot;)
</code></pre>

<pre><code>## Loading required package: BiocGenerics
</code></pre>

<pre><code>## Loading required package: parallel
</code></pre>

<pre><code>## 
## Attaching package: &#39;BiocGenerics&#39;
</code></pre>

<pre><code>## The following objects are masked from &#39;package:parallel&#39;:
## 
##     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
##     clusterExport, clusterMap, parApply, parCapply, parLapply,
##     parLapplyLB, parRapply, parSapply, parSapplyLB
</code></pre>

<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     IQR, mad, sd, var, xtabs
</code></pre>

<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     Filter, Find, Map, Position, Reduce, anyDuplicated, append,
##     as.data.frame, basename, cbind, colnames, dirname, do.call,
##     duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
##     lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
##     pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
##     tapply, union, unique, unsplit, which.max, which.min
</code></pre>

<pre><code>## Loading required package: S4Vectors
</code></pre>

<pre><code>## Loading required package: stats4
</code></pre>

<pre><code>## 
## Attaching package: &#39;S4Vectors&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     expand.grid
</code></pre>

<pre><code>## Loading required package: IRanges
</code></pre>

<pre><code>## Loading required package: XVector
</code></pre>

<pre><code>## 
## Attaching package: &#39;Biostrings&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     strsplit
</code></pre>

<pre><code class="r">data(&quot;idtax.pr2.sample&quot;)
data(&quot;idtax.silva.sample&quot;)
data(&quot;bayes.sample&quot;)
data(&quot;rubric.sample&quot;)

head(idtax.pr2.sample)
</code></pre>

<pre><code>## [[1]]
## [[1]]$taxon
## [1] &quot;Root&quot;                       &quot;Eukaryota&quot;                 
## [3] &quot;Stramenopiles&quot;              &quot;Ochrophyta&quot;                
## [5] &quot;Bacillariophyta&quot;            &quot;Bacillariophyta_X&quot;         
## [7] &quot;Polar-centric-Mediophyceae&quot; &quot;Chaetoceros&quot;               
## [9] &quot;Chaetoceros_debilis_2&quot;     
## 
## [[1]]$confidence
## [1] 82.20536 82.20536 81.01873 81.01873 81.01873 81.01873 81.01873 81.01873
## [9] 30.03599
## 
## 
## [[2]]
## [[2]]$taxon
## [1] &quot;Root&quot;                       &quot;Eukaryota&quot;                 
## [3] &quot;Stramenopiles&quot;              &quot;Ochrophyta&quot;                
## [5] &quot;Bacillariophyta&quot;            &quot;Bacillariophyta_X&quot;         
## [7] &quot;Polar-centric-Mediophyceae&quot; &quot;Thalassiosira&quot;             
## [9] &quot;Thalassiosira_hispida&quot;     
## 
## [[2]]$confidence
## [1] 71.33810 71.33810 66.29660 64.95401 64.95401 64.95401 59.40574 19.26610
## [9] 16.38823
## 
## 
## [[3]]
## [[3]]$taxon
## [1] &quot;Root&quot;           &quot;Eukaryota&quot;      &quot;Stramenopiles&quot;  &quot;Ochrophyta&quot;    
## [5] &quot;MOCH-2&quot;         &quot;MOCH-2_X&quot;       &quot;MOCH-2_XX&quot;      &quot;MOCH-2_XXX&quot;    
## [9] &quot;MOCH-2_XXX_sp.&quot;
## 
## [[3]]$confidence
## [1] 67.78686 67.78686 61.88273 58.94742 49.33213 49.33213 49.33213 49.33213
## [9] 49.33213
## 
## 
## [[4]]
## [[4]]$taxon
## [1] &quot;Root&quot;             &quot;Eukaryota&quot;        &quot;Archaeplastida&quot;   &quot;Streptophyta&quot;    
## [5] &quot;Embryophyceae&quot;    &quot;Embryophyceae_X&quot;  &quot;Embryophyceae_XX&quot; &quot;Taxus&quot;           
## [9] &quot;Taxus_baccata&quot;   
## 
## [[4]]$confidence
## [1] 45.398229 45.398229 18.583773 18.157256 12.643442 12.643442 12.643442
## [8]  8.117989  8.117989
## 
## 
## [[5]]
## [[5]]$taxon
## [1] &quot;Root&quot;           &quot;Eukaryota&quot;      &quot;Stramenopiles&quot;  &quot;Opalozoa&quot;      
## [5] &quot;MAST-3&quot;         &quot;MAST-3B&quot;        &quot;MAST-3B_X&quot;      &quot;MAST-3B_XX&quot;    
## [9] &quot;MAST-3B_XX_sp.&quot;
## 
## [[5]]$confidence
## [1] 92.47240 92.47240 90.81644 47.09622 46.51236 45.64512 45.64512 45.64512
## [9] 45.64512
</code></pre>

<pre><code class="r">head(idtax.silva.sample)
</code></pre>

<pre><code>## [[1]]
## [[1]]$taxon
## [1] &quot;Root&quot;              &quot;Eukaryota&quot;         &quot;SAR&quot;              
## [4] &quot;Stramenopiles&quot;     &quot;Ochrophyta&quot;        &quot;Diatomea&quot;         
## [7] &quot;Bacillariophytina&quot; &quot;Mediophyceae&quot;      &quot;Chaetoceros&quot;      
## 
## [[1]]$confidence
## [1] 60.26929 55.47228 50.50453 48.89802 47.20018 46.61874 46.15582 45.57871
## [9] 43.57134
## 
## [[1]]$rank
## [1] &quot;rootrank&quot;    &quot;domain&quot;      &quot;major_clade&quot; &quot;kingdom&quot;     &quot;superphylum&quot;
## [6] &quot;phylum&quot;      &quot;subphylum&quot;   &quot;class&quot;       &quot;genus&quot;      
## 
## 
## [[2]]
## [[2]]$taxon
## [1] &quot;Root&quot;              &quot;Eukaryota&quot;         &quot;SAR&quot;              
## [4] &quot;Stramenopiles&quot;     &quot;Ochrophyta&quot;        &quot;Diatomea&quot;         
## [7] &quot;Bacillariophytina&quot; &quot;Mediophyceae&quot;      &quot;Thalassiosira&quot;    
## 
## [[2]]$confidence
## [1] 64.40876 62.34590 55.16122 48.52020 48.52020 48.52020 45.61851 38.14735
## [9] 27.39857
## 
## [[2]]$rank
## [1] &quot;rootrank&quot;    &quot;domain&quot;      &quot;major_clade&quot; &quot;kingdom&quot;     &quot;superphylum&quot;
## [6] &quot;phylum&quot;      &quot;subphylum&quot;   &quot;class&quot;       &quot;genus&quot;      
## 
## 
## [[3]]
## [[3]]$taxon
## [1] &quot;Root&quot;          &quot;Eukaryota&quot;     &quot;SAR&quot;           &quot;Stramenopiles&quot;
## [5] &quot;Ochrophyta&quot;    &quot;MOCH-2&quot;       
## 
## [[3]]$confidence
## [1] 70.91750 67.31802 64.52419 63.72148 62.63950 61.55201
## 
## [[3]]$rank
## [1] &quot;rootrank&quot;    &quot;domain&quot;      &quot;major_clade&quot; &quot;kingdom&quot;     &quot;superphylum&quot;
## [6] &quot;class&quot;      
## 
## 
## [[4]]
## [[4]]$taxon
##  [1] &quot;Root&quot;               &quot;Eukaryota&quot;          &quot;Archaeplastida&quot;    
##  [4] &quot;Chloroplastida&quot;     &quot;Charophyta&quot;         &quot;Phragmoplastophyta&quot;
##  [7] &quot;Streptophyta&quot;       &quot;Embryophyta&quot;        &quot;Tracheophyta&quot;      
## [10] &quot;Spermatophyta&quot;      &quot;Pinophyta&quot;         
## 
## [[4]]$confidence
##  [1] 55.95076 50.88138 37.40822 37.40822 37.40822 37.40822 37.40822 31.93052
##  [9] 31.93052 31.15123 29.84479
## 
## [[4]]$rank
##  [1] &quot;rootrank&quot;    &quot;domain&quot;      &quot;major_clade&quot; &quot;kingdom&quot;     &quot;subkingdom&quot; 
##  [6] &quot;phylum&quot;      &quot;subphylum&quot;   &quot;class&quot;       &quot;subclass&quot;    &quot;infraclass&quot; 
## [11] &quot;superorder&quot; 
## 
## 
## [[5]]
## [[5]]$taxon
## [1] &quot;Root&quot;          &quot;Eukaryota&quot;     &quot;SAR&quot;           &quot;Stramenopiles&quot;
## [5] &quot;MAST-3&quot;        &quot;MAST-3B&quot;      
## 
## [[5]]$confidence
## [1] 92.92780 92.36003 91.05291 91.05291 91.05291 88.60307
## 
## [[5]]$rank
## [1] &quot;rootrank&quot;    &quot;domain&quot;      &quot;major_clade&quot; &quot;kingdom&quot;     &quot;phylum&quot;     
## [6] &quot;class&quot;
</code></pre>

<pre><code class="r">head(bayes.sample)
</code></pre>

<pre><code>## $tax
##                                                                                                                                    Kingdom    
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Eukaryota&quot;
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;Eukaryota&quot;
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Eukaryota&quot;
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;Eukaryota&quot;
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Eukaryota&quot;
##                                                                                                                                    Supergroup      
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Archaeplastida&quot;
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;Stramenopiles&quot; 
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Stramenopiles&quot; 
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;Stramenopiles&quot; 
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Stramenopiles&quot; 
##                                                                                                                                    Division      
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Streptophyta&quot;
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;Opalozoa&quot;    
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Ochrophyta&quot;  
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;Ochrophyta&quot;  
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Ochrophyta&quot;  
##                                                                                                                                    Class            
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Embryophyceae&quot;  
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;MAST-3&quot;         
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Bacillariophyta&quot;
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;MOCH-2&quot;         
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Bacillariophyta&quot;
##                                                                                                                                    Order              
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Embryophyceae_X&quot;  
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;MAST-3B&quot;          
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Bacillariophyta_X&quot;
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;MOCH-2_X&quot;         
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Bacillariophyta_X&quot;
##                                                                                                                                    Family                      
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Embryophyceae_XX&quot;          
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;MAST-3B_X&quot;                 
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Polar-centric-Mediophyceae&quot;
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;MOCH-2_XX&quot;                 
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Polar-centric-Mediophyceae&quot;
##                                                                                                                                    Genus        
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Pinus&quot;      
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;MAST-3B_XX&quot; 
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Minidiscus&quot; 
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;MOCH-2_XXX&quot; 
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Chaetoceros&quot;
##                                                                                                                                    Species                
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Pinus_wallichiana&quot;    
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;MAST-3B_XX_sp.&quot;       
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Minidiscus_sp.&quot;       
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;MOCH-2_XXX_sp.&quot;       
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Chaetoceros_debilis_2&quot;
## 
## $boot
##                                                                                                                                    Kingdom
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC     100
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC           100
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC         100
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC        100
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT          100
##                                                                                                                                    Supergroup
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC         79
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC               97
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC             93
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC            66
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT              99
##                                                                                                                                    Division
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC       74
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC             95
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC           93
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC          65
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT            99
##                                                                                                                                    Class
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC    59
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC          93
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC        93
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       58
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT         98
##                                                                                                                                    Order
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC    59
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC          93
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC        93
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       58
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT         98
##                                                                                                                                    Family
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC     59
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC           93
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC         86
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC        58
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT          98
##                                                                                                                                    Genus
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC    37
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC          93
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC        59
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       58
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT         97
##                                                                                                                                    Species
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC      22
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC            93
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC          59
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC         58
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT           48
</code></pre>

<pre><code class="r">head(rubric.sample)
</code></pre>

<pre><code>## DNAStringSet object of length 5:
##     width seq                                               names               
## [1]   125 GCACCCACCGATTGAAAAGCCCG...GGTGAAGTCGTAACAAGGTCTCT sv20747
## [2]   126 ACACCTACCAATTGAATGGTCCG...GGTGAAGTTGTAACAAGGTTTCC sv14136
## [3]   127 GCACCTACCGATTGAACCATACG...GGTGAAGTCGTAACAAGGTTTCC sv17278
## [4]   130 ACTCCTACCAATTGAATGATCCA...GGAGAAGTCATAACAAGGTTACC sv3579
## [5]   124 GCACCTACCGATTGAATGGTCCG...GGTGAAGTCGTAACAAGGTTTCC sv4298
</code></pre>

<h4>ensembleTax pre-processing</h4>

<p>We see from the above that the data structures returned by our two taxonomic 
assignment algorithms are different. It is critically important that the order 
of sequences in the rubric and in the idtaxa-returned Taxon object are the same.
idtaxa does not return sequence names, but if you did not alter the order of 
your sequences as you provided them to idtaxa and/or DNAStringSet when creating 
your rubric, the ordering should be preserved and you should be good to go. </p>

<p>Here we&#39;ll run these tables through ensembleTax&#39;s pre-processing functions. 
Supplying a rubric allows ensembleTax to give each taxonomy table the same ASV-
identifying information and to better track and organize your data.</p>

<pre><code class="r">idtax.pr2.pretty &lt;- idtax2df(idtax.pr2.sample, 
                             db = &quot;pr2&quot;, 
                             ranks = NULL,
                             boot = 50,
                             rubric = rubric.sample,
                             return.conf = FALSE)
idtax.silva.pretty &lt;- idtax2df(idtax.silva.sample, 
                             db = &quot;silva&quot;, 
                             ranks = NULL,
                             boot = 50,
                             rubric = rubric.sample,
                             return.conf = FALSE)
bayes.pr2.pretty &lt;- bayestax2df(bayes.sample, 
                             db = &quot;pr2&quot;, 
                             ranks = NULL,
                             boot = 50,
                             rubric = rubric.sample,
                             return.conf = FALSE)

head(idtax.pr2.pretty)
</code></pre>

<pre><code>##       svN
## 1 sv14136
## 2 sv17278
## 3 sv20747
## 4  sv3579
## 5  sv4298
##                                                                                                                                  ASV
## 1     ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC
## 2    GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
## 3      GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT
## 4 ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC
## 5       GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
##     kingdom    supergroup   division           class             order
## 1 Eukaryota Stramenopiles Ochrophyta Bacillariophyta Bacillariophyta_X
## 2 Eukaryota Stramenopiles Ochrophyta            &lt;NA&gt;              &lt;NA&gt;
## 3 Eukaryota Stramenopiles Ochrophyta Bacillariophyta Bacillariophyta_X
## 4      &lt;NA&gt;          &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;              &lt;NA&gt;
## 5 Eukaryota Stramenopiles       &lt;NA&gt;            &lt;NA&gt;              &lt;NA&gt;
##                       family       genus species
## 1 Polar-centric-Mediophyceae        &lt;NA&gt;    &lt;NA&gt;
## 2                       &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;
## 3 Polar-centric-Mediophyceae Chaetoceros    &lt;NA&gt;
## 4                       &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;
## 5                       &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;
</code></pre>

<pre><code class="r">head(idtax.silva.pretty)
</code></pre>

<pre><code>##       svN
## 1 sv14136
## 2 sv17278
## 3 sv20747
## 4  sv3579
## 5  sv4298
##                                                                                                                                  ASV
## 1     ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC
## 2    GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
## 3      GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT
## 4 ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC
## 5       GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
##      domain       phylum   class order family genus
## 1 Eukaryota         &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;
## 2 Eukaryota Eukaryota_ph  MOCH-2  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;
## 3 Eukaryota         &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;
## 4 Eukaryota         &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;
## 5 Eukaryota       MAST-3 MAST-3B  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;
</code></pre>

<pre><code class="r">head(bayes.pr2.pretty)
</code></pre>

<pre><code>##       svN
## 1 sv14136
## 2 sv17278
## 3 sv20747
## 4  sv3579
## 5  sv4298
##                                                                                                                                  ASV
## 1     ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC
## 2    GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
## 3      GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT
## 4 ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC
## 5       GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
##     kingdom     supergroup     division           class             order
## 1 Eukaryota  Stramenopiles   Ochrophyta Bacillariophyta Bacillariophyta_X
## 2 Eukaryota  Stramenopiles   Ochrophyta          MOCH-2          MOCH-2_X
## 3 Eukaryota  Stramenopiles   Ochrophyta Bacillariophyta Bacillariophyta_X
## 4 Eukaryota Archaeplastida Streptophyta   Embryophyceae   Embryophyceae_X
## 5 Eukaryota  Stramenopiles     Opalozoa          MAST-3           MAST-3B
##                       family       genus        species
## 1 Polar-centric-Mediophyceae  Minidiscus Minidiscus_sp.
## 2                  MOCH-2_XX  MOCH-2_XXX MOCH-2_XXX_sp.
## 3 Polar-centric-Mediophyceae Chaetoceros           &lt;NA&gt;
## 4           Embryophyceae_XX        &lt;NA&gt;           &lt;NA&gt;
## 5                  MAST-3B_X  MAST-3B_XX MAST-3B_XX_sp.
</code></pre>

<p>We see that each taxonomy table is now a dataframe sorted by the column &ldquo;svN&rdquo;. </p>

<h4>The taxmapper algorithm</h4>

<p>After pre-processing our taxonomic assignment data sets above, we see we still
can&#39;t make apples-to-apples comparisons across between the &ldquo;idtax-silva&rdquo; table 
and the two others because they employ different ranking and (though this may 
not be as obvious) naming conventions. <em>taxmapper</em> was created to solve this 
problem. </p>

<p>Here we&#39;ll use taxmapper to &#39;translate&#39; the idtax-silva taxonomic assignments 
onto the same taxonomic nomenclature as the other two tables.</p>

<pre><code class="r">idtax.silva.mapped2pr2 &lt;- taxmapper(idtax.silva.pretty,
                      tt.ranks = colnames(idtax.silva.pretty)[3:ncol(idtax.silva.pretty)],
                      tax2map2 = &quot;pr2&quot;,
                      exceptions = c(&quot;Archaea&quot;, &quot;Bacteria&quot;),
                      ignore.format = TRUE,
                      synonym.file = &quot;default&quot;,
                      streamline = TRUE,
                      outfilez = NULL)
head(idtax.silva.mapped2pr2)
</code></pre>

<pre><code>##       svN
## 1 sv14136
## 2 sv17278
## 3 sv20747
## 4  sv3579
## 5  sv4298
##                                                                                                                                  ASV
## 1     ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC
## 2    GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
## 3      GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT
## 4 ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC
## 5       GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
##     kingdom    supergroup   division  class   order family genus species
## 1 Eukaryota          &lt;NA&gt;       &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;
## 2 Eukaryota Stramenopiles Ochrophyta MOCH-2    &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;
## 3 Eukaryota          &lt;NA&gt;       &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;
## 4 Eukaryota          &lt;NA&gt;       &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;
## 5 Eukaryota Stramenopiles   Opalozoa MAST-3 MAST-3B   &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;
</code></pre>

<p>Inspection of the mapped taxonomy table shows that it now mirrors the naming and
ranking conventions of the other two taxonomy tables.</p>

<h4>The ensembleTax algorithm</h4>

<p>Now we have three different taxonomy tables with independent taxonomic 
assignments for each ASV in our example data set. From these we can compute 
ensemble taxonomic assignments with the <em>ensembleTax</em> algorithm.</p>

<p>We&#39;ll do a few runs to show a range of outcomes that might be achieved by 
implementing the algorithm under different parameter spaces.</p>

<p>Here&#39;s a run with the default parameters:</p>

<pre><code class="r">xx &lt;- list(idtax.pr2.pretty, idtax.silva.mapped2pr2, bayes.pr2.pretty)
names(xx) &lt;- c(&quot;idtax-pr2&quot;, &quot;idtax-silva&quot;, &quot;bayes-pr2&quot;)
eTax1 &lt;- ensembleTax(xx, 
                     tablenames = names(xx), 
                     ranknames = c(&quot;kingdom&quot;, &quot;supergroup&quot;, &quot;division&quot;,&quot;class&quot;,&quot;order&quot;,&quot;family&quot;,&quot;genus&quot;,&quot;species&quot;),
                     tiebreakz = &quot;none&quot;, 
                     count.na=TRUE, 
                     assign.threshold = 0, 
                     weights=rep(1,length(xx)))
head(eTax1)
</code></pre>

<pre><code>##       svN
## 1 sv14136
## 2 sv17278
## 3 sv20747
## 4  sv3579
## 5  sv4298
##                                                                                                                                  ASV
## 1     ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC
## 2    GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
## 3      GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT
## 4 ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC
## 5       GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
##     kingdom    supergroup   division           class             order
## 1 Eukaryota Stramenopiles Ochrophyta Bacillariophyta Bacillariophyta_X
## 2 Eukaryota Stramenopiles Ochrophyta          MOCH-2              &lt;NA&gt;
## 3 Eukaryota Stramenopiles Ochrophyta Bacillariophyta Bacillariophyta_X
## 4 Eukaryota          &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;              &lt;NA&gt;
## 5 Eukaryota Stramenopiles   Opalozoa          MAST-3           MAST-3B
##                       family       genus species
## 1 Polar-centric-Mediophyceae        &lt;NA&gt;    &lt;NA&gt;
## 2                       &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;
## 3 Polar-centric-Mediophyceae Chaetoceros    &lt;NA&gt;
## 4                       &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;
## 5                       &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;
</code></pre>

<p>Just as an example of what is possible, we might tell <em>ensembleTax</em> not to count 
non-assignments (NA&#39;s) by setting <em>count.na = FALSE</em>. Further, we might specify 
that the assignments in the idtax-pr2 table should be weighted double the other 
two (<em>weights = c(2,1,1)</em>) if we suspect that these are the most robust 
assignments for our ASV data set. Here&#39;s what that looks like:</p>

<pre><code class="r">eTax2 &lt;- ensembleTax(xx, 
                     tablenames = names(xx), 
                     ranknames = c(&quot;kingdom&quot;, &quot;supergroup&quot;, &quot;division&quot;,&quot;class&quot;,&quot;order&quot;,&quot;family&quot;,&quot;genus&quot;,&quot;species&quot;),
                     tiebreakz = &quot;none&quot;, 
                     count.na=FALSE, 
                     assign.threshold = 0, 
                     weights=c(2,1,1))
head(eTax2)
</code></pre>

<pre><code>##       svN
## 1 sv14136
## 2 sv17278
## 3 sv20747
## 4  sv3579
## 5  sv4298
##                                                                                                                                  ASV
## 1     ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC
## 2    GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
## 3      GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT
## 4 ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC
## 5       GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
##     kingdom     supergroup     division           class             order
## 1 Eukaryota  Stramenopiles   Ochrophyta Bacillariophyta Bacillariophyta_X
## 2 Eukaryota  Stramenopiles   Ochrophyta          MOCH-2          MOCH-2_X
## 3 Eukaryota  Stramenopiles   Ochrophyta Bacillariophyta Bacillariophyta_X
## 4 Eukaryota Archaeplastida Streptophyta   Embryophyceae   Embryophyceae_X
## 5 Eukaryota  Stramenopiles     Opalozoa          MAST-3           MAST-3B
##                       family       genus        species
## 1 Polar-centric-Mediophyceae  Minidiscus Minidiscus_sp.
## 2                  MOCH-2_XX  MOCH-2_XXX MOCH-2_XXX_sp.
## 3 Polar-centric-Mediophyceae Chaetoceros           &lt;NA&gt;
## 4           Embryophyceae_XX        &lt;NA&gt;           &lt;NA&gt;
## 5                  MAST-3B_X  MAST-3B_XX MAST-3B_XX_sp.
</code></pre>

<p>One more making use of the tiebreakz argument: </p>

<pre><code class="r">eTax3 &lt;- ensembleTax(xx, 
                     tablenames = names(xx), 
                     ranknames = c(&quot;kingdom&quot;, &quot;supergroup&quot;, &quot;division&quot;,&quot;class&quot;,&quot;order&quot;,&quot;family&quot;,&quot;genus&quot;,&quot;species&quot;),
                     tiebreakz = c(&quot;bayes-pr2&quot;), 
                     count.na=TRUE, 
                     assign.threshold = 0, 
                     weights=c(1,1,2))
head(eTax3)
</code></pre>

<pre><code>##       svN
## 1 sv14136
## 2 sv17278
## 3 sv20747
## 4  sv3579
## 5  sv4298
##                                                                                                                                  ASV
## 1     ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC
## 2    GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
## 3      GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT
## 4 ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC
## 5       GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
##     kingdom     supergroup     division           class             order
## 1 Eukaryota  Stramenopiles   Ochrophyta Bacillariophyta Bacillariophyta_X
## 2 Eukaryota  Stramenopiles   Ochrophyta          MOCH-2          MOCH-2_X
## 3 Eukaryota  Stramenopiles   Ochrophyta Bacillariophyta Bacillariophyta_X
## 4 Eukaryota Archaeplastida Streptophyta   Embryophyceae   Embryophyceae_X
## 5 Eukaryota  Stramenopiles     Opalozoa          MAST-3           MAST-3B
##                       family       genus        species
## 1 Polar-centric-Mediophyceae  Minidiscus Minidiscus_sp.
## 2                  MOCH-2_XX  MOCH-2_XXX MOCH-2_XXX_sp.
## 3 Polar-centric-Mediophyceae Chaetoceros           &lt;NA&gt;
## 4           Embryophyceae_XX        &lt;NA&gt;           &lt;NA&gt;
## 5                  MAST-3B_X  MAST-3B_XX MAST-3B_XX_sp.
</code></pre>

</body>

</html>
